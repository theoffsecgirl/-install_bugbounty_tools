#!/bin/bash

# Directorios de trabajo
BUG_BOUNTY_TOOLS_DIR=~/bugbounty-tools
EXPLOITS_DIR="$BUG_BOUNTY_TOOLS_DIR/exploits"
ENUMERATION_DIR="$BUG_BOUNTY_TOOLS_DIR/enumeration"
SCANNING_DIR="$BUG_BOUNTY_TOOLS_DIR/scanning"
FUZZING_DIR="$BUG_BOUNTY_TOOLS_DIR/fuzzing"
MISC_DIR="$BUG_BOUNTY_TOOLS_DIR/misc"
WORDLIST_DIR="$BUG_BOUNTY_TOOLS_DIR/wordlists"

# Crear los directorios si no existen
mkdir -p "$EXPLOITS_DIR" "$ENUMERATION_DIR" "$SCANNING_DIR" "$FUZZING_DIR" "$MISC_DIR" "$WORDLIST_DIR"

# Actualizar e instalar herramientas esenciales
sudo apt update && sudo apt upgrade -y
sudo apt install -y git curl build-essential python3-pip golang

# Añadir Go al PATH si no está
export PATH=$PATH:/usr/local/go/bin

# Función para instalar herramientas con git
function install_from_git {
    local repo_url=$1
    local target_dir=$2
    git clone "$repo_url" "$target_dir"
}

# Subdomain Enumeration Tools
echo "Instalando herramientas de enumeración de subdominios..."

install_from_git "https://github.com/projectdiscovery/subfinder.git" "$ENUMERATION_DIR/subfinder"
install_from_git "https://github.com/OWASP/Amass.git" "$ENUMERATION_DIR/amass"
install_from_git "https://github.com/tomnomnom/assetfinder.git" "$ENUMERATION_DIR/assetfinder"

# Compilar Subfinder y Amass
cd "$ENUMERATION_DIR/subfinder/v2/cmd/subfinder" && go build && sudo cp subfinder /usr/local/bin/
cd "$ENUMERATION_DIR/amass" && go build ./... && sudo cp amass /usr/local/bin/

# Port Scanning Tools
echo "Instalando herramientas de escaneo de puertos..."

sudo apt install -y masscan nmap
install_from_git "https://github.com/RustScan/RustScan.git" "$SCANNING_DIR/rustscan"

# Compilar RustScan
cd "$SCANNING_DIR/rustscan" && cargo build --release && sudo cp target/release/rustscan /usr/local/bin/

# Content Discovery Tools
echo "Instalando herramientas de descubrimiento de contenido..."

sudo apt install -y gobuster
install_from_git "https://github.com/epi052/feroxbuster.git" "$FUZZING_DIR/feroxbuster"
cd "$FUZZING_DIR/feroxbuster" && cargo build --release && sudo cp target/release/feroxbuster /usr/local/bin/

# Vulnerability Scanning Tools
echo "Instalando herramientas de escaneo de vulnerabilidades..."

install_from_git "https://github.com/projectdiscovery/nuclei.git" "$SCANNING_DIR/nuclei"
cd "$SCANNING_DIR/nuclei/v2/cmd/nuclei" && go build && sudo cp nuclei /usr/local/bin/

install_from_git "https://github.com/projectdiscovery/httpx.git" "$SCANNING_DIR/httpx"
cd "$SCANNING_DIR/httpx/cmd/httpx" && go build && sudo cp httpx /usr/local/bin/

# Fuzzing Tools
echo "Instalando herramientas de fuzzing..."

sudo apt install -y ffuf wfuzz

# Exploitation Tools
echo "Instalando herramientas de explotación..."

install_from_git "https://github.com/commixproject/commix.git" "$EXPLOITS_DIR/commix"
sudo ln -s "$EXPLOITS_DIR/commix/commix.py" /usr/local/bin/commix

install_from_git "https://github.com/s0md3v/Corsy.git" "$EXPLOITS_DIR/corsy"

# Herramientas adicionales mencionadas en la lista de Awesome Bug Bounty Tools

# Eyewitness - Para screenshots y análisis de sitios
install_from_git "https://github.com/FortyNorthSecurity/EyeWitness.git" "$MISC_DIR/eyewitness"
cd "$MISC_DIR/eyewitness/Python/setup" && sudo ./setup.sh

# SecLists - Wordlists
echo "Descargando wordlists..."

git clone https://github.com/danielmiessler/SecLists.git "$WORDLIST_DIR/seclists"

# Finalización
echo "Instalación completada. Todas las herramientas han sido instaladas correctamente."
